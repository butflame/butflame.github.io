---
layout: post
title: redis zset 实现：跳表
category: tech
tag: 数据结构
---

## redis有序集合的底层实现

本文将分别介绍[跳表](#skiplist)和redis的[有序集合](#zset)

<h3 id="skiplist">跳表</h3>

_参考文献_
> Skip Lists: A Probabilistic Alternative to Balanced Trees ---- William Pugh


_跳表是一种可替代平衡树的数据结构。跳表实现概率期望上的平衡，而非如平衡数的严格平衡。基于此，跳表的插入和删除操作相较平衡树大大简化，也明显更快。_

<br/>

平衡树常用于实现字典、顺序列表等数据结构，当元素以随机顺序插入时表现很好，但在某些操作顺序下——例如插入已经排好序的数据，将使平衡树退化到很差的性能。_(译者注：将导致平衡树特性全部失效，插入操作类似链表，需要遍历完全部数据）_ 如果能将插入元素进行随机排列，平衡树绝大部分情况下能保证高效。然而绝大部分情况下请求需要即时返回，所以预先随机排列是不现实的。平衡树的算法通过重排列树中元素来保证树的平衡及其性能。

基于概率的跳表可作为平衡树的替换选项，跳表通过随机为元素决定层数来实现平衡。尽管跳表在最坏情况下的性能很差，但不存在某种输入序列能稳定的得到最坏情况（与快速排序随机选定pivot非常类似），跳表仅有极小的概率会变得显著不平衡。跳表的平衡性类似于随机插入生成的搜索树，然而跳表并不需要**“随机”**插入。

实现概率上的平衡要比维护严格的平衡简单很多，对于很多应用场景，跳表相比平衡树更符合直觉，对应的算法实现也更简单，这种实现上的简单性使其要达成效率提升、并保持稳定的高效会比使用平衡树或_自调节树_更简单。并且跳表的空间效率也非常优秀，对其中的每个元素，平均只需要1<sup>1/3</sup>个指针，并且不需要额外的信息来记录平衡性或优先级。

---

施工中


<h3 id="zset">redis的有序集合</h3>
